{% extends "frontpage/base.html" %}

{% load staticfiles %}
{% block content %}
<link rel="stylesheet" type="text/css" href="{% static 'frontpage/style.css' %}" />

<h1> {{object.name}} </h1>
<table>
<tr> <td> Nombre del paquete</td><td> <a href="/frontpage/{{object.app.id}}" >{{object.app.package_name}} </td>
<tr> <td> Versión</td><td> {{object.app.version}} </td>	
<tr> <td> Descripción</td><td> {{object.description | linebreaks}} </td>
{% if object.vuln_class %}
	<tr>
		<td> Clase </td>
		<td>
			<a href="/frontpage/{{object.app.id}}/classes/{{object.vuln_class}}" target="_blank"> {{object.vuln_class}} </a>
		</td>
	</tr>
{% endif %}
{% if object.details %}
	<tr>
		<td> Detalles </td>
		<td>
			{{object.details}} 
		</td>
	</tr>
{% endif %}
<!-- <tr> <td> Clase </td><td> {{object.}} </td> -->
<tr> <td> Confianza </td><td> {{object.confidence}} </td>
<tr> <td> Severidad </td><td> {{object.severity}} </td>
<tr> <td> Probable dinámicamente? </td><td> {{object.dynamicTest}} </td>
</table>

{% if object.dynamictestresults_set.all %}
<table>
	<tr>
<!-- 	<th> Nombre </th> -->
		<th> Estado </th>
		<th> Intentos </th>
		<th> Descripcion </th>
	</tr>
{% for dyntest in object.dynamictestresults_set.all %}
	<tr> 
<!-- 	<td> {{dyntest.name}}</td> -->
		<td> {{dyntest.status}}</td>
		<td> {{dyntest.count}}</td>
		<td> {{dyntest.description}}</td>
	</tr>
{% endfor %}
</table>
{% endif %}
{% if object.app_comments_set.all %}
<h2> Comentarios </h2>
<table>
	<tr>
		<th> Autor </th>
		<th> Comentario </th>
	</tr>

	{% for comment in object.app_comments_set.all %}
	<tr>
		<td> {{ comment.author.username }}</td>
		<td> {{ comment.contents }}</td>
		<td> 
			<form action="/frontpage/Comentarios/{{comment.id}}/delete/" method="post">
            	{% csrf_token %}
                <input type="submit" value="Borrar"/>
            </form>
        </td>
	</tr>
	{% endfor %}
</table>
{% endif %}
<form action="/frontpage/Vulnerabilidades/{{object.id}}/Comentarios/" method="post">	
	{% csrf_token %}
	{{form}}
	<input type="submit" value="Submit"/>
</form>
{% endblock %}